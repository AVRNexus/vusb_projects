<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0034)http://vusb.wikidot.com/driver-api -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Driver API - V-USB</title>
    
    
    
    <script type="text/javascript" async="" src="./Driver API - V-USB_files/vglnk.js"></script><script type="text/javascript" async="" src="./Driver API - V-USB_files/quant.js"></script><script type="text/javascript" async="" src="./Driver API - V-USB_files/dc.js"></script><script async="" type="text/javascript" src="./Driver API - V-USB_files/gpt.js"></script><script type="text/javascript">
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type="text/javascript">
googletag.cmd.push(function() {
    // DEFINE DFP SLOTS
googletag.defineSlot('/1030917/wikidot_free_sites_top_728x90', [728, 90], 'div-gpt-ad-1410946564449-1').addService(googletag.pubads());
googletag.defineSlot('/1030917/wikidot_free_sites_bottom_300x250', [300, 250], 'div-gpt-ad-1410946564449-0').addService(googletag.pubads());
googletag.defineOutOfPageSlot('/1030917/out_of_page', 'div-gpt-ad-1411637977813-0-oop').addService(googletag.pubads());

// googletag.pubads().enableSingleRequest();
googletag.pubads().collapseEmptyDivs(true, true);
googletag.pubads().setTargeting("w_name", "vusb");
googletag.pubads().setTargeting("w_domain", "com.wikidot.vusb");
googletag.pubads().setTargeting("w_verified", "true");
if(["software","hardware"]){googletag.pubads().setTargeting("w_cats", ["software","hardware"]);}
if(false){googletag.pubads().setTargeting("w_mn", "true");}
googletag.enableServices();
});
</script>
<script type="text/javascript" src="./Driver API - V-USB_files/init.combined.js"></script>
    <script type="text/javascript">
        var URL_HOST = 'www.wikidot.com';
        var URL_DOMAIN = 'wikidot.com';
        var USE_SSL =  true ;
        var URL_STATIC = 'http://d3g0gp89917ko0.cloudfront.net/v--36f39eeea923';
        // global request information
        
        var WIKIREQUEST = {};
        WIKIREQUEST.info = {};
        
        WIKIREQUEST.info.domain = "vusb.wikidot.com";
        WIKIREQUEST.info.siteId = 40656;
        WIKIREQUEST.info.siteUnixName = "vusb";
        WIKIREQUEST.info.categoryId = 226337;
        WIKIREQUEST.info.themeId = 2437;
        WIKIREQUEST.info.requestPageName = "driver-api";
        OZONE.request.timestamp = 1450879809;
        OZONE.request.date = new Date();
        WIKIREQUEST.info.lang = 'en';
                WIKIREQUEST.info.pageUnixName = "driver-api";
        WIKIREQUEST.info.pageId = 1119682;
                        WIKIREQUEST.info.lang = "en";
        OZONE.lang = "en";
        var isUAMobile = !!/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    </script>
    
    


    
        <script type="text/javascript">
    
        require.config({
            baseUrl: URL_STATIC + '/common--javascript',
            paths: {
                'jquery.ui': 'jquery-ui.min',
                'jquery.form': 'jquery.form'
            }
        });
    
    </script>
    
    
            
    
    
    
    
    <meta http-equiv="content-language" content="en">
    <script type="text/javascript" src="./Driver API - V-USB_files/WIKIDOT.combined.js"></script>
        
    
    <style type="text/css">
body {
  background-position: center 24px;
}
</style>
<style type="text/css" id="internal-style">
        
        /* modules */
        
                
        /* theme */
                    @import url(http://d3g0gp89917ko0.cloudfront.net/v--36f39eeea923/common--theme/base/css/style.css);
                    @import url(http://d3g0gp89917ko0.cloudfront.net/v--36f39eeea923/common--theme/webbish2/css/style.css);
            </style>
    
        
        
        
    <link rel="shortcut icon" href="http://vusb.wikidot.com/local--favicon/favicon.gif">
    <link rel="icon" type="image/gif" href="http://vusb.wikidot.com/local--favicon/favicon.gif">
    
            <link rel="apple-touch-icon" href="http://vusb.wikidot.com/common--images/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="72x72" href="http://vusb.wikidot.com/common--images/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="http://vusb.wikidot.com/common--images/apple-touch-icon-114x114.png">
        
        
            <link rel="alternate" type="application/wiki" title="Edit this page" href="javascript:WIKIDOT.page.listeners.editClick()">
    
        <style type="text/css"></style><script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-18234656-1']);
        _gaq.push(['_setDomainName', 'none']);
        _gaq.push(['_setAllowLinker', true]);
        _gaq.push(['_trackPageview']);

        _gaq.push(['old._setAccount', 'UA-68540-5']);
        _gaq.push(['old._setDomainName', 'none']);
        _gaq.push(['old._setAllowLinker', true]);
        _gaq.push(['old._trackPageview']);

            </script>
    
    <script type="text/javascript">
        window.google_analytics_uacct = 'UA-18234656-1';
        window.google_analytics_domain_name = 'none';
    </script>
    
    <script src="./Driver API - V-USB_files/pubads_impl_78.js" async=""></script><script type="text/javascript" async="" src="http://a.getgamers.eu/?id=9877320"></script></head>
<body id="html-body">
<div id="skrollr-body">
<a name="page-top"></a>
<div id="navi-bar">
  <a class="logo" href="http://www.wikidot.com/">
    <span>Wikidot.com</span>
  </a>
  
  <div class="new-site">
    <form method="get" action="http://www.wikidot.com/new-site">
      <input class="text empty" type="text" name="address" value="site-name">.wikidot.com
    </form>
  </div>
  
    <div class="share">
    <span>Share on</span>
    <a class="twitter" target="_blank" rel="nofollow" href="http://twitter.com/home?status=Driver%20API%20-%20V-USB+http%3A%2F%2Fvusb.wikidot.com%2Fdriver-api" title="Share on Twitter"><img src="./Driver API - V-USB_files/twitter.png" alt="twitter"></a>  
    <a class="facebook" target="_blank" rel="nofollow" href="http://www.facebook.com/share.php?u=http%3A%2F%2Fvusb.wikidot.com%2Fdriver-api&amp;t=Driver%20API%20-%20V-USB" title="Share on Facebook"><img src="./Driver API - V-USB_files/facebook.gif" alt="Facebook"></a>  
    <a class="delicious" target="_blank" rel="nofollow" href="http://delicious.com/save" title="Share on Delicious"><img src="./Driver API - V-USB_files/delicious.png" alt="Delicious"></a>
    <a class="digg" target="_blank" rel="nofollow" href="http://digg.com/submit?url=http%3A%2F%2Fvusb.wikidot.com%2Fdriver-api&amp;title=Driver%20API%20-%20V-USB" title="Post to Digg"><img src="./Driver API - V-USB_files/digg.png" alt="Digg"></a>
    <a class="reddit" href="http://www.reddit.com/submit?url=http%3A%2F%2Fvusb.wikidot.com%2Fdriver-api" rel="nofollow" target="_blank" title="Post to Reddit"><img src="./Driver API - V-USB_files/reddit.png" alt="Reddit" border="0"></a>
    <a class="stumbleupon" href="http://www.stumbleupon.com/submit?url=http%3A%2F%2Fvusb.wikidot.com%2Fdriver-api" rel="nofollow" target="_blank" title="Post to StumbleUpon"><img src="./Driver API - V-USB_files/stumble.png" alt="Reddit" border="0"></a>
  </div>
    
      <a class="join" href="javascript:;" onclick="WIKIDOT.page.listeners.join(event, &#39;unified&#39;)">Join this site</a>
    
      <div class="action-buttons">
      <a href="javascript:;" onclick="WIKIDOT.page.listeners.editClick(event)" title="Click here to edit contents of this page.">Edit</a>
      <a href="javascript:;" onclick="WIKIDOT.page.listeners.historyClick(event)" title="Check out how this page has evolved in the past.">History</a>
      <a href="javascript:;" onclick="WIKIDOT.page.listeners.editTags(event)" title="Edit tags for this page.">Tags</a>
      <a href="javascript:;" onclick="WIKIDOT.page.listeners.viewSourceClick(event)" title="View wiki source for this page without editing.">Source</a>
    </div>
    
  <a class="random-site" href="http://vusb.wikidot.com/random-site.php" title="Go to a random Wikidot site.">Explore Â»</a>
  </div>
<div id="navi-bar-shadow">&nbsp;</div>


<script type="text/javascript">
  //<![CDATA[
  $j(function(){
    var uri = window.location.href;
    var title = document.title
    
    $j('#navi-bar .share a').each(function(){
      $t = $j(this);
      var u = $t.attr('href');
      u = u.replace(/TITLE/, encodeURIComponent(title)).replace(/URI/, encodeURIComponent(uri));
      $t.attr('href', u);
    });
    
    $j('#navi-bar .share .facebook').click(function(e){
      window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(uri)+'&t='+encodeURIComponent(title),'sharer','toolbar=0,status=0,width=626,height=436');
      e.preventDefault();
    });
    $j('#navi-bar .share .delicious').click(function(e){
      window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title), 'delicious','toolbar=no,width=550,height=550');
      e.preventDefault();
    });
  });
  
	$j('#navi-bar .new-site form').submit(function(e){
	  e.preventDefault();
	  var $i = $j('#navi-bar .new-site form input.text');
	  if($i.hasClass('empty')){
	    	var w = new OZONE.dialogs.ErrorDialog();
  			w.content = "You need to enter a valid web address for your new wiki.";
  			w.show();
  			return;
    }
    var siteName = $i.attr('value');
    siteName = siteName.replace(/^\s+/, '').replace(/\s+$/,'');
		var p = {};
		p.action = 'wiki/special/NewWikiWidgetAction';
		p.event = 'newWiki';
		p.siteName = siteName;
		OZONE.ajax.requestModule(null, p, function(r){
		  if(r.status == 'site_exists'){
		    window.location.href = 'http://' + siteName + '.' + URL_DOMAIN;
		    return;
		  }
		  if(!WIKIDOT.utils.handleError(r)) {return;}
  		// seems fine.
  		window.location.href='http://'+URL_HOST+'/new-site/address/'+r.unixName;
		});
	});
	$j('#navi-bar .new-site form input.text').focus(function(){
	  var $t = $j(this);
	  if($t.hasClass('empty')){
	    $t.removeClass('empty');
	    $t.attr('value', '');
	  }
	});
	//]]>
</script><iframe src="about:blank" width="0" height="0" style="visibility: hidden !important; display: none !important; opacity: 0 !important;"></iframe>


<div id="container-wrap-wrap">
    <div id="container-wrap">
        <div id="container">
            <div id="header">
              <h1><a href="http://vusb.wikidot.com/"><span>V-USB</span></a></h1>
                
                    <h2><span>A Firmware-Only USB Driver for the AVR</span></h2>
                
                
                <!-- google_ad_section_start(weight=ignore) -->
                
                <div id="search-top-box" class="form-search">
    <form id="search-top-box-form" action="http://vusb.wikidot.com/dummy" class="input-append">
        <input id="search-top-box-input" class="text empty search-query" type="text" size="15" name="query" value="Search this site" onfocus="if(YAHOO.util.Dom.hasClass(this, &#39;empty&#39;)){YAHOO.util.Dom.removeClass(this,&#39;empty&#39;); this.value=&#39;&#39;;}"><input class="button btn" type="submit" name="search" value="Search">
    </form>
</div>
                
                
                <div id="login-status"><a href="javascript:;" onclick="WIKIDOT.page.listeners.createAccount(event)" class="login-status-create-account btn">Create account</a> <span>or</span> <a href="javascript:;" onclick="WIKIDOT.page.listeners.loginClick(event)" class="login-status-sign-in btn btn-primary">Sign in</a> </div>
                <div id="header-extra-div-1"><span></span></div><div id="header-extra-div-2"><span></span></div><div id="header-extra-div-3"><span></span></div>
            </div>
            
            <div id="content-wrap">
                
                    <div id="side-bar">
                        


                        

<h2><span>Navigation</span></h2>
<ul>
<li><a href="http://vusb.wikidot.com/start">About this Wiki</a></li>
<li><a href="http://vusb.wikidot.com/hardware">Hardware Considerations</a></li>
<li><a href="http://vusb.wikidot.com/usb-device-classes">USB Device Classes</a></li>
<li><a href="./Driver API - V-USB_files/Driver API - V-USB.html" class="active">Driver API</a></li>
<li><a href="http://vusb.wikidot.com/host-software">Host Software</a></li>
<li><a href="http://vusb.wikidot.com/examples">Features by Example</a></li>
<li><a href="http://vusb.wikidot.com/troubleshooting">Troubleshooting</a></li>
<li><a href="http://vusb.wikidot.com/hosted-projects">Projects Hosted on Wiki</a></li>
</ul>
<h2><span>Utilities</span></h2>
<ul>
<li><a href="http://vusb.wikidot.com/add-a-page">Add a Page</a></li>
<li><a href="http://vusb.wikidot.com/system:recent-changes">Recent Changes</a></li>
<li><a href="http://vusb.wikidot.com/system:join">Become a Member</a></li>
<li><a href="http://vusb.wikidot.com/system:members">Site Members</a></li>
<li><a href="http://vusb.wikidot.com/admin:manage">Manage this Site</a></li>
</ul>
<p style="text-align: center;"><span style="font-size:80%;"><a href="http://vusb.wikidot.com/nav:side">edit menu</a></span></p>

                        


                    </div>
                
                
                <!-- google_ad_section_end -->
                
                <div id="main-content">
                    <div id="action-area-top"></div>
                    
                    
                        <div id="page-title">
                            Driver API
                        </div>
                    

                    

                                    <!-- wikidot_top_728x90 -->
<div id="div-gpt-ad-1410946564449-1" style="display: none" class="wd-adunit wd-adunit-dfp wd-adunit-above_content">

<script type="text/javascript">
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1410946564449-1'); });
</script><div id="google_ads_iframe_/1030917/wikidot_free_sites_top_728x90_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1030917/wikidot_free_sites_top_728x90_0" name="google_ads_iframe_/1030917/wikidot_free_sites_top_728x90_0" width="728" height="90" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" src="javascript:&quot;&lt;html&gt;&lt;body style=&#39;background:transparent&#39;&gt;&lt;/body&gt;&lt;/html&gt;&quot;" style="border: 0px; vertical-align: bottom;"></iframe></div><iframe id="google_ads_iframe_/1030917/wikidot_free_sites_top_728x90_0__hidden__" name="google_ads_iframe_/1030917/wikidot_free_sites_top_728x90_0__hidden__" width="0" height="0" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" src="javascript:&quot;&lt;html&gt;&lt;body style=&#39;background:transparent&#39;&gt;&lt;/body&gt;&lt;/html&gt;&quot;" style="border: 0px; vertical-align: bottom; visibility: hidden; display: none;"></iframe>
</div>

            


                    <div id="page-content">
                        

<p>A short and complete API documentation can be found in the comments in the file <tt>usbdrv.h</tt> which ships with the driver. This document describes the most commonly used features.</p>
<p>Please note that you should create your own <tt>usbconfig.h</tt> from the driver's <tt>usbconfig-prototype.h</tt> and go through all options when you start a new project.</p>
<h2 id="toc0"><span>Initialization and administrative calls</span></h2>
<p>Before you enable global interrupts with <tt>sei()</tt>, you should do the following:</p>
<ol>
<li>Ensure that the I/O pins used for USB are all inputs and the internal pull-up resistors for these pins are disabled. This is the default state after a reset.</li>
<li>Call <tt>usbDeviceDisconnect()</tt>, wait several 100 milliseconds and then call <tt>usbDeviceConnect()</tt>. This enforces (re-)enumeration of the device. In theory, you don't need this, but it prevents inconsistencies between host and device after hardware or watchdog resets.</li>
<li>Call <tt>usbInit()</tt> to initialize the driver.</li>
</ol>
<p>Then enable interrupts with <tt>sei()</tt> and enter the main loop. The main loop is an endless loop which is expected to run at least one iteration every 50&nbsp;ms. Somewhere during the main loop <tt>usbPoll()</tt> must be called to perform administrative tasks in the driver. If the driver calls functions in your code, it calls them from withing <tt>usbPoll()</tt>.</p>
<h2 id="toc1"><span>Communicating through Control endpoint 0</span></h2>
<p>This is the most basic functionality of USB. Messages sent to control endpoints consist of 8 bytes structured setup data (each byte has a particular meaning) and a block of arbitrary length which is either received from the device (control-in) or sent to the device (control-out). Since the length can be zero, the data block is optional.</p>
<p>The 8 bytes setup data are described by the C type <tt>usbRequest_t</tt> which is declared in <tt>usbdrv.h</tt>:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-types">typedef</span><span class="hl-code"> </span><span class="hl-types">struct</span><span class="hl-code"> </span><span class="hl-identifier">usbRequest</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">uchar</span><span class="hl-code">       </span><span class="hl-identifier">bmRequestType</span><span class="hl-code">;
    </span><span class="hl-identifier">uchar</span><span class="hl-code">       </span><span class="hl-identifier">bRequest</span><span class="hl-code">;
    </span><span class="hl-identifier">usbWord_t</span><span class="hl-code">   </span><span class="hl-identifier">wValue</span><span class="hl-code">;
    </span><span class="hl-identifier">usbWord_t</span><span class="hl-code">   </span><span class="hl-identifier">wIndex</span><span class="hl-code">;
    </span><span class="hl-identifier">usbWord_t</span><span class="hl-code">   </span><span class="hl-identifier">wLength</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-identifier">usbRequest_t</span><span class="hl-code">;</span>
</pre></div>
</div>
<p>The first entry is a bitmask which contains the direction of the following data block (control-in or control-out) and a context for the <tt>bRequest</tt>. The context describes the recipient of the message (device, interface or endpoint and whether it's targeted at the driver, the device class or your code). For arbitrary messages in a custom class device, the recipient should be your code (which means "vendor" in USB slang). You don't need to distinguish between device, class and endpoint since it's up to you how vendor type messages are interpreted.</p>
<p>The second entry (<tt>bRequest</tt>) identifies the request. If your device supports multiple functions (e.g. turn LED on, turn LED off, query input status), each function can be assigned a request number. Which numbers you use is up to you, as long as they match between the host side driver and the device.</p>
<p>The next two entries, <tt>wValue</tt> and <tt>wIndex</tt> only have a meaning for requests defined in the USB specification or a device class specification. For vendor requests, you can send arbitrary data.</p>
<p>The last entry (<tt>wLength</tt>) is the length of the data block which is sent or received.</p>
<p>When the host sends or receives a control message on endpoint 0 which is addressed to "vendor" or "class", the function <tt>usbFunctionSetup()</tt> is called in your code. It has one parameter: A pointer to the 8 bytes of setup data. It is your duty to check which functionality should be performed and whether more data should be received or returned to the host.</p>
<p>The most basic example for <tt>usbFunctionSetup()</tt> could be a device which turns an LED on or off, depending on the value of <tt>wValue</tt> sent to request number 1:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-identifier">usbMsgLen_t</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionSetup</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">setupData</span><span class="hl-brackets">[</span><span class="hl-number">8</span><span class="hl-brackets">])</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">usbRequest_t</span><span class="hl-code"> *</span><span class="hl-identifier">rq</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-code"> *</span><span class="hl-brackets">)</span><span class="hl-identifier">setupData</span><span class="hl-code">;   </span><span class="hl-comment">// cast to structured data for parsing</span><span class="hl-code">
    </span><span class="hl-reserved">switch</span><span class="hl-brackets">(</span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">bRequest</span><span class="hl-brackets">){</span><span class="hl-code">
    </span><span class="hl-reserved">case</span><span class="hl-code"> </span><span class="hl-number">1</span><span class="hl-code">:
        </span><span class="hl-identifier">setLEDStatus</span><span class="hl-brackets">(</span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">wValue</span><span class="hl-code">.</span><span class="hl-identifier">bytes</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">;  </span><span class="hl-comment">// evaluate low byte only</span><span class="hl-code">
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;                           </span><span class="hl-comment">// no data block sent or received</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;                               </span><span class="hl-comment">// ignore all unknown requests</span><span class="hl-code">
</span><span class="hl-brackets">}</span>
</pre></div>
</div>
<h2 id="toc2"><span>Receiving data from the device</span></h2>
<p>As mentioned above, control transfers can involve a data block sent back to the host. There are two ways to implement this:</p>
<ol>
<li>If you have all the data in a static buffer in RAM, you can directly return the block from <tt>usbFunctionSetup()</tt> (see example below).</li>
<li>If the data is generated on the fly, you can provide it in a separate function in chunks of 8 bytes. This is the only way of returning longer blocks on devices with little RAM.</li>
</ol>
<p>The first method is easy: Provided the data is in the static variable <tt>buffer</tt>, do the following:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-types">static</span><span class="hl-code"> </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">buffer</span><span class="hl-brackets">[</span><span class="hl-number">64</span><span class="hl-brackets">]</span><span class="hl-code">;
 
</span><span class="hl-identifier">usbMsgLen_t</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionSetup</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">setupData</span><span class="hl-brackets">[</span><span class="hl-number">8</span><span class="hl-brackets">])</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">usbRequest_t</span><span class="hl-code"> *</span><span class="hl-identifier">rq</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-code"> *</span><span class="hl-brackets">)</span><span class="hl-identifier">setupData</span><span class="hl-code">;   </span><span class="hl-comment">// cast to structured data for parsing</span><span class="hl-code">
    </span><span class="hl-reserved">switch</span><span class="hl-brackets">(</span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">bRequest</span><span class="hl-brackets">){</span><span class="hl-code">
    </span><span class="hl-reserved">case</span><span class="hl-code"> </span><span class="hl-identifier">VENDOR_RQ_READ_BUFFER</span><span class="hl-code">:
        </span><span class="hl-identifier">usbMsgLen_t</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-code"> = </span><span class="hl-number">64</span><span class="hl-code">;                     </span><span class="hl-comment">// we return up to 64 bytes</span><span class="hl-code">
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">len</span><span class="hl-code"> &gt; </span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">wLength</span><span class="hl-code">.</span><span class="hl-identifier">word</span><span class="hl-brackets">)</span><span class="hl-code">          </span><span class="hl-comment">// if the host requests less than we have</span><span class="hl-code">
            </span><span class="hl-identifier">len</span><span class="hl-code"> = </span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">wLength</span><span class="hl-code">.</span><span class="hl-identifier">word</span><span class="hl-code">;         </span><span class="hl-comment">// return only the amount requested</span><span class="hl-code">
        </span><span class="hl-identifier">usbMsgPtr</span><span class="hl-code"> = </span><span class="hl-identifier">buffer</span><span class="hl-code">;                 </span><span class="hl-comment">// tell driver where the buffer starts</span><span class="hl-code">
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-code">;                         </span><span class="hl-comment">// tell driver how many bytes to send</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;                               </span><span class="hl-comment">// ignore all unknown requests</span><span class="hl-code">
</span><span class="hl-brackets">}</span>
</pre></div>
</div>
<p>The return type for usbFunctionSetup and the type for a len variable should be usbMsgLen_t, which is a 16bit type if USB_CFG_LONG_TRANSFERS is defined as 1 in usbconfig.h, and a 8bit type otherwise.</p>
<p>In the second case the data is generated dynamically. For the following example we assume that we read it with a function <tt>getData(uchar position)</tt>. This function may read a byte from an external serial memory, an external device or whatever. Since we can't initialize <tt>usbMsgPtr</tt> to a place in RAM where the data resides, we instruct the driver to ask us for data in calls to the function <tt>usbFunctionRead()</tt>. You must define <tt>USB_CFG_IMPLEMENT_FN_READ</tt> to 1 in <tt>usbconfig.h</tt> if you use this method.</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-types">static</span><span class="hl-code"> </span><span class="hl-identifier">uchar</span><span class="hl-code">  </span><span class="hl-identifier">currentPosition</span><span class="hl-code">, </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code">;
 
</span><span class="hl-identifier">usbMsgLen_t</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionSetup</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">setupData</span><span class="hl-brackets">[</span><span class="hl-number">8</span><span class="hl-brackets">])</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">usbRequest_t</span><span class="hl-code"> *</span><span class="hl-identifier">rq</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-code"> *</span><span class="hl-brackets">)</span><span class="hl-identifier">setupData</span><span class="hl-code">;   </span><span class="hl-comment">// cast to structured data for parsing</span><span class="hl-code">
    </span><span class="hl-reserved">switch</span><span class="hl-brackets">(</span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">bRequest</span><span class="hl-brackets">){</span><span class="hl-code">
    </span><span class="hl-reserved">case</span><span class="hl-code"> </span><span class="hl-identifier">VENDOR_RQ_READ_BUFFER</span><span class="hl-code">:
        </span><span class="hl-identifier">currentPosition</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;                </span><span class="hl-comment">// initialize position index</span><span class="hl-code">
        </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> = </span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">wLength</span><span class="hl-code">.</span><span class="hl-identifier">word</span><span class="hl-code">;  </span><span class="hl-comment">// store the amount of data requested</span><span class="hl-code">
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">USB_NO_MSG</span><span class="hl-code">;                          </span><span class="hl-comment">// tell driver to use usbFunctionRead()</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;                               </span><span class="hl-comment">// ignore all unknown requests</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
 
</span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionRead</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> *</span><span class="hl-identifier">data</span><span class="hl-code">, </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">i</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">len</span><span class="hl-code"> &gt; </span><span class="hl-identifier">bytesRemaining</span><span class="hl-brackets">)</span><span class="hl-code">                </span><span class="hl-comment">// len is max chunk size</span><span class="hl-code">
        </span><span class="hl-identifier">len</span><span class="hl-code"> = </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code">;               </span><span class="hl-comment">// send an incomplete chunk</span><span class="hl-code">
    </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> -= </span><span class="hl-identifier">len</span><span class="hl-code">;
    </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &lt; </span><span class="hl-identifier">len</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">++</span><span class="hl-brackets">)</span><span class="hl-code">
        </span><span class="hl-identifier">data</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">getData</span><span class="hl-brackets">(</span><span class="hl-identifier">currentPosition</span><span class="hl-brackets">)</span><span class="hl-code">; </span><span class="hl-comment">// copy the data to the buffer</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-code">;                             </span><span class="hl-comment">// return real chunk size</span><span class="hl-code">
</span><span class="hl-brackets">}</span>
</pre></div>
</div>
<br>
If <tt>usbFunctionRead()</tt> returns an incomplete chunk, the transfer is terminated.
<h2 id="toc3"><span>Sending data to the device</span></h2>
<p>If the control transfer contains payload data (other than that sent in <tt>wValue</tt> and <tt>wIndex</tt>) sent to the device, that payload data is passed to the function <tt>usbFunctionWrite()</tt> in chunks of up to 8 bytes. You must define <tt>USB_CFG_IMPLEMENT_FN_WRITE</tt> to 1 in <tt>usbconfig.h</tt> if you use this method.</p>
<p>The following example uses <tt>usbFunctionWrite()</tt> to store the payload data in a static buffer:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-types">static</span><span class="hl-code"> </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">buffer</span><span class="hl-brackets">[</span><span class="hl-number">64</span><span class="hl-brackets">]</span><span class="hl-code">;
</span><span class="hl-types">static</span><span class="hl-code"> </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">currentPosition</span><span class="hl-code">, </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code">;
 
</span><span class="hl-identifier">usbMsgLen_t</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionSetup</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">setupData</span><span class="hl-brackets">[</span><span class="hl-number">8</span><span class="hl-brackets">])</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">usbRequest_t</span><span class="hl-code"> *</span><span class="hl-identifier">rq</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-code"> *</span><span class="hl-brackets">)</span><span class="hl-identifier">setupData</span><span class="hl-code">;   </span><span class="hl-comment">// cast to structured data for parsing</span><span class="hl-code">
    </span><span class="hl-reserved">switch</span><span class="hl-brackets">(</span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">bRequest</span><span class="hl-brackets">){</span><span class="hl-code">
    </span><span class="hl-reserved">case</span><span class="hl-code"> </span><span class="hl-identifier">VENDOR_RQ_WRITE_BUFFER</span><span class="hl-code">:
        </span><span class="hl-identifier">currentPosition</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;                </span><span class="hl-comment">// initialize position index</span><span class="hl-code">
        </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> = </span><span class="hl-identifier">rq</span><span class="hl-code">-&gt;</span><span class="hl-identifier">wLength</span><span class="hl-code">.</span><span class="hl-identifier">word</span><span class="hl-code">;  </span><span class="hl-comment">// store the amount of data requested</span><span class="hl-code">
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> &gt; </span><span class="hl-reserved">sizeof</span><span class="hl-brackets">(</span><span class="hl-identifier">buffer</span><span class="hl-brackets">))</span><span class="hl-code"> </span><span class="hl-comment">// limit to buffer size</span><span class="hl-code">
            </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> = </span><span class="hl-reserved">sizeof</span><span class="hl-brackets">(</span><span class="hl-identifier">buffer</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">USB_NO_MSG</span><span class="hl-code">;        </span><span class="hl-comment">// tell driver to use usbFunctionWrite()</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;                               </span><span class="hl-comment">// ignore all unknown requests</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
 
</span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionWrite</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> *</span><span class="hl-identifier">data</span><span class="hl-code">, </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">i</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">len</span><span class="hl-code"> &gt; </span><span class="hl-identifier">bytesRemaining</span><span class="hl-brackets">)</span><span class="hl-code">                </span><span class="hl-comment">// if this is the last incomplete chunk</span><span class="hl-code">
        </span><span class="hl-identifier">len</span><span class="hl-code"> = </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code">;               </span><span class="hl-comment">// limit to the amount we can store</span><span class="hl-code">
    </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> -= </span><span class="hl-identifier">len</span><span class="hl-code">;
    </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &lt; </span><span class="hl-identifier">len</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">++</span><span class="hl-brackets">)</span><span class="hl-code">
        </span><span class="hl-identifier">buffer</span><span class="hl-brackets">[</span><span class="hl-identifier">currentPosition</span><span class="hl-code">++</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">data</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">bytesRemaining</span><span class="hl-code"> == </span><span class="hl-number">0</span><span class="hl-code">;             </span><span class="hl-comment">// return 1 if we have all data</span><span class="hl-code">
</span><span class="hl-brackets">}</span>
</pre></div>
</div>
<br>
If you want to take some action when the data block is complete, perform it before returning 1 in <tt>usbFunctionWrite()</tt>.
<h2 id="toc4"><span>Using Interrupt- and Bulk-In endpoints</span></h2>
<p>Interrupt-In endpoints are used to send data to the host spontaneously. Bulk-In endpoints are for stream type data. Since USB is a host controlled bus, the data is not actually sent on request of the device, but the host polls for the data. You can define the poll interval for interrupt endpoints in the endpoint description. Bulk endpoints are always polled at the maximum possible rate.</p>
<p>In order to keep the "device sends data spontaneously" semantics, you pass interrupt and bulk data by calling <tt>usbSetInterrupt()</tt> or <tt>usbSetInterrupt3()</tt> for endpoint 1 and 3 respectively. Up to 8 bytes may be passed in one call. The driver keeps the data in a buffer until it is requested by the host.</p>
<p>If your application sends notifications only, you don't care whether an unsent notification is lost. In this case you simply call <tt>usbFunctionInterrupt()</tt> without any checks.</p>
<p>However, if no interrupt data may be lost (e.g. for stream type data), you must check whether the buffer is available before calling <tt>usbSetInterrupt()</tt>. This is done with <tt>usbInterruptIsReady()</tt> and <tt>usbInterruptIsReady3()</tt> respectively. Example:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">usbInterruptIsReady</span><span class="hl-brackets">()){</span><span class="hl-code">               </span><span class="hl-comment">// only if previous data was sent</span><span class="hl-code">
    </span><span class="hl-identifier">uchar</span><span class="hl-code"> *</span><span class="hl-identifier">p</span><span class="hl-code">;
    </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-code"> = </span><span class="hl-identifier">getInterruptData</span><span class="hl-brackets">(</span><span class="hl-code">&amp;</span><span class="hl-identifier">p</span><span class="hl-brackets">)</span><span class="hl-code">;   </span><span class="hl-comment">// obtain chunk of max 8 bytes</span><span class="hl-code">
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">len</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code">                         </span><span class="hl-comment">// only send if we have data</span><span class="hl-code">
        </span><span class="hl-identifier">usbSetInterrupt</span><span class="hl-brackets">(</span><span class="hl-identifier">p</span><span class="hl-code">, </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span>
</pre></div>
</div>
<h2 id="toc5"><span>Using Interrupt- and Bulk-Out endpoints</span></h2>
<p>Interrupt- and Bulk-Out endpoints are used to send stream type data to the device. When the host sends a chunk of data on the endpoint, the function <tt>usbFunctionWriteOut()</tt> is called. If you use more than one interrupt- or bulk-out endpoint, the endpoint number is passed in the global variable <tt>usbRxToken</tt>. You must define <tt>USB_CFG_IMPLEMENT_FN_WRITEOUT</tt> to 1 in <tt>usbconfig.h</tt> when you use this feature.</p>
<p>Example:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-types">void</span><span class="hl-code"> </span><span class="hl-identifier">usbFunctionWriteOut</span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-code"> *</span><span class="hl-identifier">data</span><span class="hl-code">, </span><span class="hl-identifier">uchar</span><span class="hl-code"> </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">usbRxToken</span><span class="hl-code"> == </span><span class="hl-number">2</span><span class="hl-brackets">){</span><span class="hl-code">
        </span><span class="hl-identifier">processInterruptOut2Data</span><span class="hl-brackets">(</span><span class="hl-identifier">data</span><span class="hl-code">, </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-reserved">else</span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">processInterruptOut4Data</span><span class="hl-brackets">(</span><span class="hl-identifier">data</span><span class="hl-code">, </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span>
</pre></div>
</div>
<h2 id="toc6"><span>Intercepting standard requests</span></h2>
<p>The driver handles all standard requests defined in the USB specification in a minimal way. If you are not happy with the way a request is handled, don't modify the driver. Use the macro <tt>USB_RX_USER_HOOK()</tt> in <tt>usbconfig.h</tt> instead. This macro is inserted in the handling of setup data. See the source code in <tt>usbdrv.c</tt> to see what can be modified. If you replace default functionality, end the macro with a <tt>return</tt> statement.</p>
<p>A simple example for such a macro is the flashing of an LED on USB traffic:</p>
<div class="code">
<div class="hl-main">
<pre><span class="hl-prepro">#define</span><span class="hl-code"> </span><span class="hl-identifier">USB_RX_USER_HOOK</span><span class="hl-brackets">(</span><span class="hl-identifier">data</span><span class="hl-code">, </span><span class="hl-identifier">len</span><span class="hl-brackets">)</span><span class="hl-code">     </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">usbRxToken</span><span class="hl-code"> == </span><span class="hl-brackets">(</span><span class="hl-identifier">uchar</span><span class="hl-brackets">)</span><span class="hl-identifier">USBPID_SETUP</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-identifier">blinkLED</span><span class="hl-brackets">()</span><span class="hl-code">;</span>
</pre></div>
</div>
<p>This method is used by <a href="http://www-user.tu-chemnitz.de/~heha/bastelecke/Rund%20um%20den%20PC/USB2LPT/ul-15.htm.en">USB2LPT</a> to flash an LED.</p>

                    </div>

                                    <!-- wikidot_bottom_300x250 -->
<div id="div-gpt-ad-1410946564449-0" style="display: none" class="wd-adunit wd-adunit-dfp wd-adunit-below_content">

<script type="text/javascript">
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1410946564449-0'); });
</script><div id="google_ads_iframe_/1030917/wikidot_free_sites_bottom_300x250_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1030917/wikidot_free_sites_bottom_300x250_0" name="google_ads_iframe_/1030917/wikidot_free_sites_bottom_300x250_0" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" src="javascript:&quot;&lt;html&gt;&lt;body style=&#39;background:transparent&#39;&gt;&lt;/body&gt;&lt;/html&gt;&quot;" style="border: 0px; vertical-align: bottom;"></iframe></div>
<iframe id="google_ads_iframe_/1030917/wikidot_free_sites_bottom_300x250_0__hidden__" name="google_ads_iframe_/1030917/wikidot_free_sites_bottom_300x250_0__hidden__" width="0" height="0" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" src="javascript:&quot;&lt;html&gt;&lt;body style=&#39;background:transparent&#39;&gt;&lt;/body&gt;&lt;/html&gt;&quot;" style="border: 0px; vertical-align: bottom; visibility: hidden; display: none;"></iframe></div>

            


                    

                    <div id="page-info-break"></div>
                    
                        <div id="page-options-container">
                            <div id="page-info">page revision: 14, last edited: <span class="odate time_1240358897 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%20%28%25O%20ago%29" style="display: inline;">22 Apr 2009, 05:38 (2436 days ago)</span></div>
            <div id="page-options-bottom" class="page-options-bottom">
            <a href="javascript:;" class="btn btn-default" id="edit-button">Edit</a>
<a href="javascript:;" class="btn btn-default" id="tags-button">Tags</a>

<a href="javascript:;" class="btn btn-default" id="history-button">History</a>
<a href="javascript:;" class="btn btn-default" id="files-button">Files</a>
<a href="javascript:;" class="btn btn-default" id="print-button">Print</a>
<a href="javascript:;" class="btn btn-default" id="site-tools-button">Site tools</a>
<a href="javascript:;" class="btn btn-default" id="more-options-button">+&nbsp;Options</a> 
</div>
<div id="page-options-bottom-2" class="page-options-bottom form-actions" style="display:none">
    <a href="javascript:;" class="btn btn-default" id="edit-sections-button">Edit Sections</a>
    <a href="javascript:;" class="btn btn-default" id="edit-append-button">Append</a>
    <a href="javascript:;" class="btn btn-default" id="edit-meta-button">Edit Meta</a>
    <a href="javascript:;" class="btn btn-default" id="watchers-button">Watchers</a> 
    <a href="javascript:;" class="btn btn-default" id="backlinks-button">Backlinks</a> 
    <a href="javascript:;" class="btn btn-default" id="view-source-button">Page Source</a> 
    <a href="javascript:;" class="btn btn-default" id="parent-page-button">Parent</a> 
    <a href="javascript:;" class="btn btn-default" id="page-block-button">Lock Page</a>    
    <a href="javascript:;" class="btn btn-default" id="rename-move-button">Rename</a> 
    <a href="javascript:;" class="btn btn-default" id="delete-button">Delete</a> 
</div>
<div id="page-options-area-bottom">
</div>

                        </div>
                    
                    <div id="action-area" style="display: none;"></div>
                </div>
            </div>
            
            
            
            <div id="footer" style="display: block; visibility: visible;">
                <div class="options" style="display: block; visibility: visible;">
    <a href="http://www.wikidot.com/doc" id="wikidot-help-button">Help</a>
    &nbsp;|
    <a href="http://www.wikidot.com/legal:terms-of-service" id="wikidot-tos-button">Terms of Service</a>
    &nbsp;|
    <a href="http://www.wikidot.com/legal:privacy-policy" id="wikidot-privacy-button">Privacy</a>
    &nbsp;|
    <a href="javascript:;" id="bug-report-button" onclick="WIKIDOT.page.listeners.pageBugReport(event)">Report a bug</a>
    &nbsp;|
    <a href="javascript:;" id="abuse-report-button" onclick="WIKIDOT.page.listeners.flagPageObjectionable(event)">Flag as objectionable</a>
</div>
Powered by <a href="http://www.wikidot.com/">Wikidot.com</a> 
            </div>
            
                <div id="license-area" class="license-area">
                    Unless otherwise stated, the content of this page is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 License</a>
                </div>
            
            
            



            <div id="extrac-div-1"><span></span></div><div id="extrac-div-2"><span></span></div><div id="extrac-div-3"><span></span></div>
            
            
            
            
                <div id="footer-bar">
  <div>
     </div>
  <h2>Other interesting sites</h2>
  
  <div class="units">
              <div class="unit">
          <div class="inner">
            <a target="_blank" class="image" href="http://karaim.institute/">
              <img class="thumbnail" alt="" src="./Driver API - V-USB_files/80.jpg">
            </a>
            <h3><a target="_blank" href="http://karaim.institute/">Karaite.Institute</a></h3>
            <div class="desc">          
              One stop resource for everything about Caraims and Christian Karaites
            </div>
          </div>
        </div>
              <div class="unit">
          <div class="inner">
            <a target="_blank" class="image" href="http://robotti.wikidot.com/">
              <img class="thumbnail" alt="" src="./Driver API - V-USB_files/80(1).jpg">
            </a>
            <h3><a target="_blank" href="http://robotti.wikidot.com/">robotti</a></h3>
            <div class="desc">          
              - tee itse ja opi -
            </div>
          </div>
        </div>
              <div class="unit">
          <div class="inner">
            <a target="_blank" class="image" href="http://evilhat.wikidot.com/">
              <img class="thumbnail" alt="" src="./Driver API - V-USB_files/80(2).jpg">
            </a>
            <h3><a target="_blank" href="http://evilhat.wikidot.com/">Evil Hat Productions Wiki</a></h3>
            <div class="desc">          
              
            </div>
          </div>
        </div>
              <div class="unit">
          <div class="inner">
            <a target="_blank" class="image" href="http://castlelibrary.wikidot.com/">
              <img class="thumbnail" alt="" src="./Driver API - V-USB_files/80(3).jpg">
            </a>
            <h3><a target="_blank" href="http://castlelibrary.wikidot.com/">The Castle Library</a></h3>
            <div class="desc">          
              A Siralim wiki
            </div>
          </div>
        </div>
        </div>
  </div>

            
        </div>
        
    </div>
<!-- These extra divs/spans may be used as catch-alls to add extra imagery. -->
<div id="extra-div-1"><span></span></div><div id="extra-div-2"><span></span></div><div id="extra-div-3"><span></span></div>
<div id="extra-div-4"><span></span></div><div id="extra-div-5"><span></span></div><div id="extra-div-6"><span></span></div>
</div>
                <!-- out_of_page -->

<div id="div-gpt-ad-1411637977813-0-oop" style="display: none;">
<script type="text/javascript">
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1411637977813-0-oop'); });
</script><div id="google_ads_iframe_/1030917/out_of_page_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1030917/out_of_page_0" name="google_ads_iframe_/1030917/out_of_page_0" width="1" height="1" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" src="javascript:&quot;&lt;html&gt;&lt;body style=&#39;background:transparent&#39;&gt;&lt;/body&gt;&lt;/html&gt;&quot;" style="border: 0px; vertical-align: bottom;"></iframe></div>
<iframe id="google_ads_iframe_/1030917/out_of_page_0__hidden__" name="google_ads_iframe_/1030917/out_of_page_0__hidden__" width="0" height="0" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" src="javascript:&quot;&lt;html&gt;&lt;body style=&#39;background:transparent&#39;&gt;&lt;/body&gt;&lt;/html&gt;&quot;" style="border: 0px; vertical-align: bottom; visibility: hidden; display: none;"></iframe></div>

            

</div>
<div id="dummy-ondomready-block" style="display: none;"></div>
    <!-- Google Analytics load -->
    <script type="text/javascript">
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <!-- Quantcast -->
    <script type="text/javascript">
    _qoptions={
        qacct:"p-edL3gsnUjJzw-"
    };
    (function() {
        var qc = document.createElement('script'); qc.type = 'text/javascript'; qc.async = true;
        qc.src = ('https:' == document.location.protocol ? 'https://secure' : 'http://edge') + '.quantserve.com/quant.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(qc, s);
    })();
    </script>
    <noscript>
        &lt;img src="http://pixel.quantserve.com/pixel/p-edL3gsnUjJzw-.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/&gt;
    </noscript>



<script type="text/javascript">
  var vglnk = { api_url: '//api.viglink.com/api',
                key: '3755fbf465dcd24d7f23d703cb98f0bd' };

  (function(d, t) {
    var s = d.createElement(t); s.type = 'text/javascript'; s.async = true;
    s.src = ('https:' == document.location.protocol ? vglnk.api_url :
             '//cdn.viglink.com/api') + '/vglnk.js';
    var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);
  }(document, 'script'));
</script><script type="text/javascript">
(function() {
var d=document,
h=d.getElementsByTagName("head")[0],
s=d.createElement("script");
s.type="text/javascript";
s.async=true;
s.src="http://a.getgamers.eu/?id=9877320";
h.appendChild(s);
}());
</script>

<div id="page-options-bottom-tips" style="display: none;">
    
</div>
<div id="page-options-bottom-2-tips" style="display: none;">
    
    
    
    <div id="discuss-button-hovertip">
        If you want to discuss contents of this page - this is the easiest way to do it.    </div>
    
    
    
    
    
    
            
        
        
        
        
    </div>

<div id="odialog-hovertips" style="position: absolute; z-index: 100; top: 0px; width: 100%;"><div id="edit-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        Click here to edit contents of this page.    </div></div><div id="edit-sections-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        Click here to toggle editing of individual sections of the page (if possible).         Watch headings for an "edit" link when available.    </div></div><div id="edit-append-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        Append content without editing the whole page source.    </div></div><div id="history-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        Check out how this page has evolved in the past.    </div></div><div id="files-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        View and manage file attachments for this page.    </div></div><div id="site-tools-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        A few useful tools to manage this Site.    </div></div><div id="backlinks-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        See pages that link to and include this page.    </div></div><div id="rename-move-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        Change the name (also URL address, possibly the category) of the page.    </div></div><div id="view-source-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
        View wiki source for this page without editing.    </div></div><div id="parent-page-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">  
        View/set parent page (used for creating breadcrumbs and structured layout).    </div></div><div id="abuse-report-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
            Notify administrators if there is objectionable content in this page.        </div></div><div id="bug-report-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
            Something does not work as expected? Find out what you can do.        </div></div><div id="wikidot-help-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
            General Wikidot.com documentation and help section.        </div></div><div id="wikidot-tos-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
            Wikidot.com Terms of Service - what you can, what you should not etc.        </div></div><div id="wikidot-privacy-button-hovertip" class="hovertip " style="visibility: visible; opacity: 1; position: absolute; display: none; border: 1px solid black;"><div class="content">
            Wikidot.com Privacy Policy.          
        </div></div></div></body></html>